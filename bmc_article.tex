\NeedsTeXFormat{LaTeX2e}[1995/12/01]
\documentclass[10pt]{bmc_article}    

% Load packages
\usepackage{url}  % Formatting web addresses  
\usepackage{ifthen}  % Conditional 
\usepackage{multicol}   %Columns
\usepackage[utf8]{inputenc} %unicode support
%\usepackage[applemac]{inputenc} %applemac support if unicode package fails
%\usepackage[latin1]{inputenc} %UNIX support if unicode package fails
\urlstyle{rm}
\usepackage[citestyle=numeric-comp]{biblatex}                                                                     
\setlength{\bibitemsep}{0cm}                                                                                                                
\renewbibmacro{in:}{%                                                                                                                       
  \ifentrytype{article}{}{%                                                                                                                 
  \printtext{\bibstring{in}\intitlepunct}}}                                                                                                 
\addbibresource{bmc_article.bib}                                                                                                                    
 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%	
%%                                             %%
%%  If you wish to display your graphics for   %%
%%  your own use using includegraphic or       %%
%%  includegraphics, then comment out the      %%
%%  following two lines of code.               %%   
%%  NB: These line *must* be included when     %%
%%  submitting to BMC.                         %% 
%%  All figure files must be submitted as      %%
%%  separate graphics through the BMC          %%
%%  submission process, not included in the    %% 
%%  submitted article.                         %% 
%%                                             %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%                     

\def\includegraphic{}
\def\includegraphics{}

\setlength{\topmargin}{0.0cm}
\setlength{\textheight}{21.5cm}
\setlength{\oddsidemargin}{0cm} 
\setlength{\textwidth}{16.5cm}
\setlength{\columnsep}{0.6cm}

\newboolean{publ}

%Review style settings
\newenvironment{bmcformat}{\begin{raggedright}\baselineskip20pt\sloppy\setboolean{publ}{false}}{\end{raggedright}\baselineskip20pt\sloppy}

%Publication style settings
%\newenvironment{bmcformat}{\fussy\setboolean{publ}{true}}{\fussy}

%%%%%%%%%%%%%%%%%%%%%%%%%%%% RESEARCH PAPER %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}
\begin{bmcformat}

\title{The Chemistry Development Kit (CDK). 3. Atom typing, Rendering, Molecular Formula, and Substructure Searching}
 
\author{
  Egon L Willighagen$^{1}$% // FIXED FIRST AUTHOR
  \email{Egon L Willighagen - egon.willighagen@ki.se}
\and
  Miguel Rojas Cherto$^2$%
  \email{Miguel Rojas Cherto - steinbeck@ebi.ac.uk}
\and
  You C B Here$^3$%
  \email{You C B Here - you.here@example.org}
\and
  C D K Project\correspondingauthor$^98$% // FIXED SECOND BUT LAST AUTHOR
  \email{C D K Project - cdk-devel@lists.sourceforge.net}
\and
  Rajarshi Guha$^99$% // FIXED ONE BUT LAST AUTHOR
  \email{Rajarshi Guha - steinbeck@ebi.ac.uk}
\and
  Christoph Steinbeck$^100$% // FIXED LAST AUTHOR
  \email{Christoph Steinbeck - steinbeck@ebi.ac.uk}
}
      
\address{
    \iid(1)Division of Molecular Toxicology, Institute of Environmental Medicine, Karolinska Institutet, SE-17177 Stockholm, Sweden\\
    \iid(2)Division of Analytical Biosciences, Leiden/Amsterdam Center for Drug Research, Leiden, The Netherlands \\
    \iid(3)Example Ltd., Glasgow, UK \\
    \iid(98)\url{http://cdk.sourceforge.net/} \\
    \iid(99)NIH Center for Translational Therapeutics, 9800 Medical Center Drive, Rockville, MD 20878, USA \\
    \iid(100)Chemoinformatics and Metabolism team, European Bioinformatics Institute, Hinxton, UK 
}

\maketitle

%% The Abstract begins here

\begin{abstract}
% Do not use inserted blank lines (ie \\) until main body of text.
\paragraph*{Background:}
Cheminformatics is a well-established field with many applications in chemistry,
drug discovery, and the life sciences. Particularly in the latter field, however,
molecular properties are not well-understood yet, and the interaction between
molecules and larger systems remains a challenge to be modeled. Therefore, the
development of new data mining and pattern recognition continues to be important
and the need for access to a cheminformatics library that one can change remains.
\paragraph*{Results:}
We here report the 1.4 series of the Chemistry Development Kit and outline how
it evolved since the previous report. We demonstrate the new APIs we introduced
in this version and discuss the extensive quality control mechanism we have
adopted. New APIs have been introduced for substructure searching, rendering of
molecules, handling of molecular formulas, atom type perception, and InChI
support. At a quality control side we have introduced automated building,
extensive unit and use case testing, and adopted peer review.
\paragraph*{Conclusions:}
With this paper we have shown the continued effort to provide a free, Open Source
cheminformatics library, and show that such colleborative projects can survive for
a long period. We have taken advantage from the community support, and show
that an open source cheminformatics project can act as a peer reviewed
publishing platform for scientific computating software.
\end{abstract}



\ifthenelse{\boolean{publ}}{\begin{multicols}{2}}{}

%%%%%%%%%%%%%%%%
%% Background %%
%%
\section*{Background}

Open Source cheminformatics state \ldots (EGON)

Adoption of the CDK ... Cinfony~\cite{OBoyle2008}, and other bindings \ldots ...

Recent prominent use cases of the CDK~\cite{Steinbeck2003,Steinbeck2006} \ldots (EGON)

 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Results and Discussion %%
%%
\section*{Results and Discussion}

\subsection*{New APIs}

Everyone is invited to contribute and write up the functionality they contributed;
only requirement: the code must have been incorporated into the main CDK library by the
time of submission of this paper.

  \subsubsection*{Atom Typing}
  
  The CDK has adopted a new atom typing algorithm \ldots (EGON)

  \subsubsection*{Rendering API}
  
  Initiated by ...
  
  \subsubsection*{Molecular Formula}

The chemical formula is the basic/simple chemical representation of a compound. It defines the number of atoms/isotopes and type of elements that constitute a chemical compound without describing how atoms are bonded.
It is also the first step toward the identification of the chemical structure from a unidentified compound.

CDK can handle several concepts related to chemical formulas
\begin{itemize}
\item Chemical formula =
\item Set of chemical formulas =
\item Range of chemical formulas =
\item Adducts =
\item Isotope Container =
\item Isotopic pattern = 
\item Rules = Filters in accepting an chemical formula
\end{itemize}

CDK can
\begin{itemize}
\item generate/print the elemental composition from a given IAtomContainer
\item calculate the isotopic pattern from a given chemical formula
\item determine the elemental composition from a given mass
\item validate a chemical formula
\item calculate the exact mass from a given chemical formula
\end{itemize}

Where can it be applied?

  \subsubsection*{SMARTS parser}
  
  ....

  \subsubsection*{Partial charges and Delocalization}
  
Partial atomic charges is an electronic property of atoms defining the asymmetric distribution of electrons in chemical bonds.
It is used as a quantitative correlation with certain compound's physical and chemical properties.

CDK can
\begin{itemize}
\item generate all resonance structures from a given compound 
\item calculate the topological and electronic weight value of each of the resonance structures
\item calculate the partial atomic charge from a given structure 
\end{itemize}

Where can it be applied?

  \subsubsection*{New Builders}

Originally, the CDK was developed as a shared library between JChemPaint and Jmol. The former
used a MVC approach with an event-passing mechanism to update the view when the model was
changed. This can cause an cascade of change events being passed around. To address,
interfaces were introduced allowing multiple implementations of the core interfaces.
% TODO: check if the interfaces have previously been defined
The IChemObjectBuilders play an important role here, allowing implementations of the
interfaces to be instantiated without the need of explicitly referencing those implementations.

However, the CDK 1.0 and 1.2 implementations of the IChemObjectBuilder had one method for
each constructor, resulting in very large interface. Moreover, the API changed whenever
a new class was introduced, and existing methods changed when constructors were updated.
To simplify the API, the new IChemObjectBuilder collapsed all methods returning new
implementations into a single method, which takes as a first parameter the class of the
interface that is wished to be constructed. All further parameters are passes as
parameter to the class constructor.

For example, to construct a new atom from its element symbol, one would now write:

\begin{verbatim}
IChemObjectBuilder builder; // previously defined
IAtom atom = builder.newInstance(IAtom.class, "C");
\end{verbatim}

Increasingly, the CDK library is now written against the interfaces, and when new instanced
are needed, these builders are being used. This allows to run a certain CDK-based
application with a specific builder, summarized in Table~\ref{tab:builders}.

\begin{table}
\begin{tabular}{l|l}
builder & description \\
\hline
DefaultChemObjectBuilder & The original builder ... \\
DataDebugChemObjectBuilder & A builder that creates classes that send debug messages ... \\
SilentChemObjectBuilder & Classes that are created with this builder will not
    send around change events. \\
\end{tabular}
\end{table}

  \subsubsection*{InChI integration}
  
  .... jni-inchi dep, atom numbering, tautomer generation
  
\subsection*{Improved Coding Standards}

As the library grew over the years, so did the maintenance become more complex. Increasingly,
the main branch did not compile, and bug fixing become increasingly difficult, as fixing a bug
in one part of the code, broke some other code which made the wrong assumption about the first
code.

To address these issues, we have adopted a number of coding standards. By no means there are
meant to implement the best practices of source code development; instead, they attempt to find
a balance between increasing code maintainability and being flexible enough to allow efficient
code development. However, we appreciate the subjective nature of this statement, and some
adopted guidelines have been heavily discussed in the community.
The next sections describe some approaches the project have adopted that allows us to
maintain the CDK library as it is today. 

  \subsubsection*{Modularization}
  
One of the key approaches we have adopted, is to make the CDK more modular. The CDK assigns
every class to a module, and defines dependencies between modules. For example, core modules
are not allowed to depend on a module holding data classes implementing the CDK interfaces;
instead, they may only depend on the interfaces themselves. This, for example, is to ensure
that dependencies are minimized and to make it easier to exclude CDK functionality with
third-party dependencies that are not needed.

... describe all modules, maybe add graphviz plot ...

  \subsubsection*{Peer review}
  
Another big changes since the CDK 1.2 series, is that the project adopted a peer-review
step in its development. New functionality is now developed independently from the main
CDK library until it is finished. When it is finished, the new code is send around to
other developers to be reviewed, very much like how research papers are peer-reviewed
by journals before publication. Independent developers review the code to check if it 
meets our community's standards.



  \subsubsection*{Documentation}

  Initially done with DocCheck, replaced by OpenJavaDocCheck ...
  
  \subsubsection*{Unit testing}
  
  \subsubsection*{Code Quality}

  PMD ...

  \subsubsection*{Git, branching, and patches}

%%%%%%%%%%%%%%%%%%%%%%
\section*{Conclusions}
  Text for this section \ldots
  
%%%%%%%%%%%%%%%%%%
\section*{Methods}
  \subsection*{Peer Review: Automated}
    \subsubsection*{PMD}
    \subsubsection*{JavaDoc Checks}
  \subsection*{Peer Review: Manual}
  \subsection*{Unit Testing}
    
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Authors contributions}
    Text for this section \ldots

    

%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Acknowledgements}
  \ifthenelse{\boolean{publ}}{\small}{}
  Text for this section \ldots


{\ifthenelse{\boolean{publ}}{\footnotesize}{\small}
\printbibliography
}

%%%%%%%%%%%

\ifthenelse{\boolean{publ}}{\end{multicols}}{}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Figures                       %%

%% Do not use \listoffigures as most will included as separate files

%\section*{Figures}
%  \subsection*{Figure 1 - Sample figure title}
%      A short description of the figure content
%      should go here.
%
%  \subsection*{Figure 2 - Sample figure title}
%      Figure legend text.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Tables                        %%

%% Use of \listoftables is discouraged.
%%
%\section*{Tables}
%  \subsection*{Table 1 - Sample table title}
%    Here is an example of a \emph{small} table in \LaTeX\ using  
%    \verb|\tabular{...}|. This is where the description of the table 
%    should go. \par \mbox{}
%    \par
%    \mbox{
%      \begin{tabular}{|c|c|c|}
%        \hline \multicolumn{3}{|c|}{My Table}\\ \hline
%        A1 & B2  & C3 \\ \hline
%        A2 & ... & .. \\ \hline
%        A3 & ..  & .  \\ \hline
%      \end{tabular}
%      }
%  \subsection*{Table 2 - Sample table title}
%    Large tables are attached as separate files but should
%    still be described here.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Additional Files              %%

%\section*{Additional Files}
%  \subsection*{Additional file 1 --- Sample additional file title}
%    Additional file descriptions text (including details of how to
%    view the file, if it is in a non-standard format or the file extension).  This might
%    refer to a multi-page table or a figure.
%
%  \subsection*{Additional file 2 --- Sample additional file title}
%    Additional file descriptions text.


\end{bmcformat}
\end{document}







